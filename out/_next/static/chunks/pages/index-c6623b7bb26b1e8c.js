(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(t,e,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(9092)}])},9092:function(t,e,s){"use strict";let n;s.r(e),s.d(e,{default:function(){return Z}});var i,r,o=s(5893),a=s(682),l=s(7294);class c{static getInstance(){return null==this.singleton&&(this.singleton=new c),this.singleton}get(t){return document.querySelector("#".concat(t))}createCanvas(){return document.createElement("canvas")}}class h{getContext(){return this.context}getHtmlCanvasElement(){return this.htmlCanvasElement}clearFrame(){this.context.clearRect(0,0,this.width,this.height)}constructor(t,e,s){this.width=t,this.height=e,this.backgroundColor=s,this.htmlCanvasElement=c.getInstance().createCanvas(),this.htmlCanvasElement.id=h.id,this.htmlCanvasElement.width=this.width,this.htmlCanvasElement.height=this.height,this.htmlCanvasElement.style.backgroundColor=this.backgroundColor;let n=this.htmlCanvasElement.getContext("2d");if(null==n)throw Error("HTML Canvas Context failed to initialize");this.context=n}}h.id="canvas";class u{static getInstance(){return null==this.singleton&&(this.singleton=new u),this.singleton}createCanvas(){return new h(1280,720,"#000000")}}class g{registerKey(t){console.log("[InputModule#registerKey] key=".concat(t)),this.keys.set(t,!0)}unregisterKey(t){console.log("[InputModule#unregisterKey] key=".concat(t)),this.keys.delete(t)}getXAxis(){let t=0;return(this.keys.has("a")||this.keys.has("ArrowLeft"))&&(t=-1),(this.keys.has("d")||this.keys.has("ArrowRight"))&&(t+=1),t}getYAxis(){let t=0;return(this.keys.has("s")||this.keys.has("ArrowDown"))&&(t=-1),(this.keys.has("w")||this.keys.has("ArrowUp"))&&(t+=1),t}keyIsDown(t){return this.keys.has(t)}getActiveKeys(){return Array.from(this.keys.keys())}constructor(){this.xAxis=0,this.yAxis=0,this.keys=new Map,window.addEventListener("keydown",t=>{t.preventDefault(),this.registerKey(t.key)}),window.addEventListener("keyup",t=>{t.preventDefault(),this.unregisterKey(t.key)})}}class d{}let p="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var y={randomUUID:p};let m=new Uint8Array(16);function f(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(m)}let w=[];for(let t=0;t<256;++t)w.push((t+256).toString(16).slice(1));var v=function(t,e,s){if(y.randomUUID&&!e&&!t)return y.randomUUID();t=t||{};let n=t.random||(t.rng||f)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){s=s||0;for(let t=0;t<16;++t)e[s+t]=n[t];return e}return function(t,e=0){return w[t[e+0]]+w[t[e+1]]+w[t[e+2]]+w[t[e+3]]+"-"+w[t[e+4]]+w[t[e+5]]+"-"+w[t[e+6]]+w[t[e+7]]+"-"+w[t[e+8]]+w[t[e+9]]+"-"+w[t[e+10]]+w[t[e+11]]+w[t[e+12]]+w[t[e+13]]+w[t[e+14]]+w[t[e+15]]}(n)};class C{static getRandom(){return v()}}class I{getScene(){return this.scene}getSprite(){return this.sprite}getTransform(){return this.transform}setScene(t){this.scene=t}setSpriteRenderer(t){this.spriteRenderer=t}update(){throw Error("Implement override")}constructor(t,e){this.id=C.getRandom(),this.enabled=!0,this.scene=null,this.transform=t,this.sprite=e,this.spriteRenderer=null}}class E extends I{update(){throw Error("Override this method")}constructor(t,e,s,n,i,r,o,a,l,c){super(t,e),this.name=s,this.maxHealth=n,this.health=i,this.accuracy=r,this.attackSpeed=o,this.critChance=a,this.critDamage=l,this.attackRange=c,this.attackTicker=0,this.abilityTicker=0,this.target=null}}class R{minus(t){return new R(this.y-t.y,this.x-t.x)}magnitude(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}constructor(t,e){this.x=t,this.y=e}}class S extends E{setKeybindModule(t){this.keybindModule=t,this.keybindModule.setPlayer(this)}update(){var t,e;let s=this.inputModule.getXAxis(),n=this.inputModule.getYAxis();this.velocity=new R(s*this.movementSpeed,-(n*this.movementSpeed*1)),this.transform.position=new R(this.transform.position.x+this.velocity.x,this.transform.position.y+this.velocity.y),null===(t=this.keybindModule)||void 0===t||t.perform(),null===(e=this.spriteRenderer)||void 0===e||e.render()}constructor(t,e,s,n,i,r,o,a,l,c,h,u){super(t,e,n,i,r,o,a,l,c,h),this.keybindModule=null,this.inputModule=s,this.inventory=u,this.velocity=new R(0,0),this.movementSpeed=8}}class b{getType(){return this.type}constructor(t){this.type=t}}class k extends b{getFill(){return this.fill}getLineWidth(){return this.lineWidth}getFillColor(){return this.fillColor}getStrokeColor(){return this.strokeColor}constructor(t,e,s,n,i){super("canvas"),this.fill=e,this.lineWidth=s,this.fillColor=n,this.strokeColor=i}}class x extends k{getWidth(){return this.width}getHeight(){return this.height}constructor(t,e,s,n,i,r){super("rectangle",s,n,i,r),this.width=t,this.height=e}}class T{constructor(t){this.position=t}}class M{setPlayer(t){this.player=t}perform(){if(null==this.player)throw Error("Must be registered to player");this.inputModule.getActiveKeys().forEach(t=>{if(null==this.player)throw Error("Must be registered to player");let e=this.keybindings.get(t);void 0!=e&&(console.log("[KeybindModule#perform] '".concat(t,"'")),e.perform(this.player.getTransform().position))})}constructor(t,e){this.player=null,this.inputModule=t,this.keybindings=e}}class A{subscribe(t){this.subscriptions.push(t)}unsubscribe(t){this.subscriptions=this.subscriptions.map(e=>e.getId()==t?null:e).filter(t=>null!=t)}publish(t){this.subscriptions.forEach(e=>e.getCallback()(t))}constructor(){this.subscriptions=[]}}(i=r||(r={}))[i.Interact=0]="Interact",i[i.ResourceCollected=1]="ResourceCollected";class D{static getInstance(){if(null==this.singleton){let t=new Map([[r.Interact,new A],[r.ResourceCollected,new A]]);this.singleton=new D(t)}return this.singleton}getTopic(t){return this.topics.get(t)}constructor(t){this.topics=t}}class _{getId(){return this.id}constructor(t){this.id=t}}class N{static getInstance(){return null==this.singleton&&(this.singleton=new N),this.singleton}overlapCircle(t,e,s){return s.filter(s=>this.pointIntersectsCircle(t,e,s.getTransform().position))}pointIntersectsCircle(t,e,s){let n=s.minus(t),i=n.magnitude();return i<=e}}class L{perform(t){console.log("[Interact#perform]");let e=N.getInstance().overlapCircle(t,this.radius,Y.getInstance().getActiveScene().getResources());e.forEach(t=>{var e;null===(e=D.getInstance().getTopic(r.Interact))||void 0===e||e.publish(new _(t.id))})}constructor(t,e){this.castTime=t,this.radius=e}}class P{static getInstance(){return null==this.singleton&&(this.singleton=new P),this.singleton}createDefault(){let t=new x(40,40,!0,2,"#ffffff","#000000"),e=new d,s=new T(new R(0,0)),n=new g,i=new Map([[" ",new L(0,55)]]),r=new M(n,i),o=new S(s,t,n,"Player",100,100,.5,1,.05,.5,100,e);return o.setKeybindModule(r),o}}class K{getId(){return this.id}getCallback(){return this.callback}constructor(t,e){this.id=t,this.callback=e}}class F extends I{collect(t){var e;t==this.id&&(console.log("[Resource#collect] ".concat(this.id," collected, disabling...")),this.enabled=!1,null===(e=D.getInstance().getTopic(r.ResourceCollected))||void 0===e||e.publish(new _(this.id)))}update(){var t;this.enabled&&(null===(t=this.spriteRenderer)||void 0===t||t.render())}constructor(t,e,s,n){var i;super(t,e),this.name=s,this.sellValue=n,null===(i=D.getInstance().getTopic(r.Interact))||void 0===i||i.subscribe(new K(this.id,t=>this.collect(t.getId())))}}class O extends k{getRadius(){return this.radius}constructor(t,e,s,n,i){super("circle",e,s,n,i),this.radius=t}}class W{static getInstance(){return null==this.singleton&&(this.singleton=new W),this.singleton}createPrometium(t){let e=new O(30,!0,2,"#ff0000","#000000"),s=new T(t);return new F(s,e,"Prometium",10)}createEndurium(t){let e=new O(30,!0,2,"#0000ff","#000000"),s=new T(t);return new F(s,e,"Endurium",10)}createTerbium(t){let e=new O(30,!0,2,"#ffff00","#000000"),s=new T(t);return new F(s,e,"Endurium",10)}}class U{render(){this.canvasContext.beginPath(),this.canvasContext.lineWidth=this.sprite.getLineWidth(),this.canvasContext.strokeStyle=this.sprite.getStrokeColor(),this.canvasContext.fillStyle=this.sprite.getFillColor(),this.canvasContext.arc(this.transform.position.x,this.transform.position.y,this.sprite.getRadius(),U.START_ANGLE,U.END_ANGLE,U.COUNTERCLOCKWISE),this.sprite.getFill()&&this.canvasContext.fill(),this.canvasContext.stroke()}constructor(t,e,s){this.sprite=t,this.canvas=e,this.transform=s,this.canvasContext=this.canvas.getContext()}}U.START_ANGLE=0,U.END_ANGLE=2*Math.PI,U.COUNTERCLOCKWISE=!1;class H{render(){this.canvasContext.beginPath(),this.canvasContext.lineWidth=this.sprite.getLineWidth(),this.canvasContext.strokeStyle=this.sprite.getStrokeColor(),this.canvasContext.fillStyle=this.sprite.getFillColor(),this.canvasContext.rect(this.transform.position.x,this.transform.position.y,this.sprite.getWidth(),this.sprite.getHeight()),this.sprite.getFill()&&this.canvasContext.fill(),this.canvasContext.stroke()}constructor(t,e,s){this.sprite=t,this.canvas=e,this.transform=s,this.canvasContext=this.canvas.getContext()}}class G{static getInstance(){return null==this.singleton&&(this.singleton=new G),this.singleton}create(t,e,s){if(e instanceof h){if(t instanceof x)return new H(t,e,s);if(t instanceof O)return new U(t,e,s)}else console.log("[SpriteRendererFactory#create] not CanvasDisplay");throw Error("Invalid argument combination")}}class q{setResourceSpawnEngine(t){this.resourceSpawnEngine=t,this.resourceSpawnEngine.setScene(this)}getWidth(){return this.width}getHeight(){return this.height}getPlayers(){return this.players}getResources(){return this.resources}setResources(t){this.resources=t}addRenderable(t){this.players.push(t)}generateSpriteRenderers(t){let e=G.getInstance();this.players.forEach(s=>{let n=s.getSprite();if(null==n)return;let i=e.create(n,t,s.getTransform());s.setSpriteRenderer(i)})}update(){var t;this.resources.forEach(t=>t.update()),this.players.forEach(t=>t.update()),null===(t=this.resourceSpawnEngine)||void 0===t||t.update()}constructor(t,e,s,n){this.width=t,this.height=e,this.players=s,this.resources=n,this.resourceSpawnEngine=null}}class V{handleResourceCollected(t){console.log("[ResourceSpawnEngine#handleResourceCollected] ".concat(t," collected. Deleting..."))}setScene(t){this.scene=t}update(){if(null==this.scene)return;let t=this.scene.getResources().length;if(t>=this.maxResources)return;let e=this.createRandomResource();console.log("\n      [ResourceSpawnEngine] quantity=".concat(t," -\n      Adding 1 to (").concat(e.getTransform().position.x,", ").concat(e.getTransform().position.y,")\n    ").trim());let s=e.getSprite();if(null==s)return;let n=Y.getInstance().getDisplay();if(null==n)return;let i=G.getInstance().create(s,n,e.getTransform());e.setSpriteRenderer(i),this.scene.getResources().push(e)}createRandomResource(){let t=this.createRandomPosition(),e=this.getRandomInt(1,3);switch(e){case 1:return this.resourceFactory.createPrometium(t);case 2:return this.resourceFactory.createEndurium(t);case 3:return this.resourceFactory.createTerbium(t);default:throw Error("Invalid roll")}}createRandomPosition(){if(null==this.scene)throw Error("Scene must be present");return new R(this.getRandomInt(0,this.scene.getWidth()),this.getRandomInt(0,this.scene.getHeight()))}getRandomInt(t,e){return Math.floor(Math.random()*e)+t}constructor(t,e){var s;this.resourceFactory=t,this.maxResources=e,this.scene=null,null===(s=D.getInstance().getTopic(r.ResourceCollected))||void 0===s||s.subscribe(new K("resource-spawn-engine",t=>this.handleResourceCollected(t.getId())))}}class X{static getInstance(){return null==this.singleton&&(this.singleton=new X),this.singleton}createScenes(){return[this.createOneOne()]}createOneOne(){let t=new q(1360,765,[],[]),e=W.getInstance(),s=new V(e,100);return t.setResourceSpawnEngine(s),t}}class j{static getInstance(){return null==this.singleton&&(this.singleton=new j),this.singleton}createDefault(){let t=P.getInstance().createDefault(),e=X.getInstance().createScenes(),s=D.getInstance(),n=new Y(s,e);return t.setScene(n.getActiveScene()),n.setPlayer(t),n}}class Y{static getInstance(){return null==this.singleton&&(this.singleton=j.getInstance().createDefault()),this.singleton}getActiveScene(){return this.activeScene}getDisplay(){return this.display}setDisplay(t){this.display=t,this.scenes.forEach(e=>e.generateSpriteRenderers(t))}setPlayer(t){this.player=t,this.getActiveScene().addRenderable(this.player)}update(){if(null==this.display)throw Error("Display must be present");this.display.clearFrame(),this.activeScene.update()}start(){if(console.log("[Game#start] running: ".concat(this.running)),!this.running){if(null==this.display)throw Error("Display must be presetn");this.interval=window.setInterval(()=>{Y.getInstance().update()},Y.TICK_IN_MILLISECONDS),this.running=!0}}constructor(t,e){if(this.display=null,this.player=null,this.running=!1,this.interval=null,this.eventSystem=t,this.scenes=e,this.scenes.length<1)throw Error("At least 1 Scene required");this.activeScene=e[0]}}Y.TICK_IN_MILLISECONDS=50;let z=()=>{let t="container";return(0,l.useEffect)(()=>{let e=c.getInstance().get(t);if(!e)return;let s=u.getInstance().createCanvas(),n=c.getInstance().get("canvas");null!=n&&n.remove(),e.insertAdjacentElement("beforeend",s.getHtmlCanvasElement());let i=Y.getInstance();i.setDisplay(s),i.start()},[]),(0,o.jsx)(a.Z,{id:t,className:"mt-3"})};var Z=z}},function(t){t.O(0,[774,888,179],function(){return t(t.s=8312)}),_N_E=t.O()}]);